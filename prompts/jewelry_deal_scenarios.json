{
  "description": "سناریوهای نمونه برای معاملات طلا و جواهر. context (مانده‌ها، حساب‌ها) در زمان اجرا از سیستم داده می‌شود؛ user_input همان چیزی است که کاربر می‌گوید.",
  "transaction_types_reference": [
    "Sell Raw Gold",
    "Buy Raw Gold",
    "Receive Money",
    "Send Money",
    "Receive Raw Gold",
    "Give Raw Gold",
    "Receive Jewelry",
    "Give Jewelry"
  ],
  "scenarios": [
    {
      "id": "debt_settlement_gold_and_cash",
      "title": "تسویه بدهی طلا: بخش طلا، بخش نقد",
      "context": {
        "person": "آقای زمانی",
        "person_role": "همکار",
        "prior_state": "ما به آقای زمانی ۱۲ گرم طلا بدهکاریم (ماندهٔ او: +۱۲ گرم طلا). context از دیتابیس توسط سیستم داده می‌شود، نه توسط کاربر."
      },
      "user_input": "۸ گرم طلا به آقای زمانی دادم و ۲۰۰۰ دلار برای ۴ گرم از حساب haspa پرداختم",
      "reasoning": "کاربر کل بدهی ۱۲ گرم را تسویه می‌کند: (۱) ۸ گرم با دادن طلای فیزیکی → Give Raw Gold 8g. (۲) ۴ گرم باقی با نقد → Buy Raw Gold 4g قیمت 2000، و Send Money 2000 از haspa. ترتیب: دادن طلا، خرید طلا (تسویه)، فرستادن پول.",
      "expected_transaction_count": 3,
      "expected_output": [
        {
          "customer_id": "<Zamani_customer_id>",
          "transaction_type": "Give Raw Gold",
          "details": { "weight_grams": 8, "purity": 18 },
          "notes": "۸ گرم طلا به آقای زمانی داده شد؛ بخشی از تسویه بدهی ۱۲ گرمی"
        },
        {
          "customer_id": "<Zamani_customer_id>",
          "transaction_type": "Buy Raw Gold",
          "details": { "purity": 18, "weight_grams": 4, "price": 2000 },
          "notes": "۴ گرم بدهی با نقد تسویه شد؛ طلای فیزیکی دریافت نشد"
        },
        {
          "customer_id": "<Zamani_customer_id>",
          "transaction_type": "Send Money",
          "details": { "amount": 2000, "bank_account_id": "<haspa_account_id>" },
          "notes": "۲۰۰۰ دلار از حساب Haspa برای تسویه ۴ گرم پرداخت شد"
        }
      ],
      "outcome": "ماندهٔ طلای آقای زمانی صفر می‌شود (۱۲ − ۸ − ۴).",
      "rules_for_ai": [
        "وقتی کاربر می‌گوید «X گرم دادم» و «Y دلار برای Z گرم از حساب <account> پرداختم»، خروجی ۳ تراکنش: Give Raw Gold X g، Buy Raw Gold Z g قیمت Y، Send Money Y از حساب نام‌برده.",
        "با context سیستم تأیید کن: X + Z = مقدار بدهی. نام شخص و حساب را به ID از context نگاشت کن."
      ]
    },
    {
      "id": "jewelry_sale_settle_debt_via_collaborator",
      "title": "فروش جنس به مشتری نهایی؛ مشتری به همکار پول می‌دهد؛ ما بدهی طلا را تسویه می‌کنیم",
      "context": {
        "person_collaborator": "آقای زمانی",
        "prior_state": "ما به آقای زمانی ۱۲ گرم طلا بدهکاریم (ماندهٔ او: +۱۲ گرم طلا). بعد از تسویه ۸ گرم، باقی = ۴ گرم.",
        "end_user": "مشتری نهایی که جنس را می‌خرد.",
        "jewelry": "قلم جواهر شماره ۱۲ (از context از jewelry_code استفاده کن، مثلاً «۱۲» یا «ITEM-12»)."
      },
      "user_input": "قلم جواهر شماره ۱۲ را به یک مشتری نهایی به ۳۰۰۰ دلار فروختیم و او آن را به آقای زمانی برای ۸ گرم طلا پرداخت کرد",
      "reasoning": "پنج گام منطقی: (۱) فروش قلم به مشتری نهایی (۲) تحویل قلم به مشتری (۳) دریافت ۳۰۰۰ از مشتری (۴) خرید ۸ گرم از آقای زمانی — تسویه ۸ گرم بدهی (۵) پرداخت ۳۰۰۰ به آقای زمانی. در API، «فروش» و «تحویل قلم» یک تراکنش است: Give Jewelry. پس ۴ تراکنش API: Give Jewelry، Receive Money (۳۰۰۰ از مشتری)، Buy Raw Gold (۸ گرم از زمانی، قیمت ۳۰۰۰)، Send Money (۳۰۰۰ به زمانی).",
      "expected_transaction_count": 4,
      "logical_steps": [
        "۱. فروش قلم به مشتری نهایی",
        "۲. تحویل قلم به مشتری",
        "۳. دریافت ۳۰۰۰ دلار از مشتری",
        "۴. خرید ۸ گرم از آقای زمانی",
        "۵. پرداخت ۳۰۰۰ دلار به آقای زمانی"
      ],
      "api_note": "گام‌های ۱ و ۲ در API به یک تراکنش Give Jewelry نگاشت می‌شوند. پس ۵ گام منطقی → ۴ تراکنش API.",
      "expected_output": [
        {
          "customer_id": "<end_user_customer_id>",
          "transaction_type": "Give Jewelry",
          "details": { "jewelry_code": "<jewelry_code_item_12>" },
          "notes": "قلم جواهر شماره ۱۲ به مشتری نهایی فروخته و تحویل داده شد"
        },
        {
          "customer_id": "<end_user_customer_id>",
          "transaction_type": "Receive Money",
          "details": { "amount": 3000, "bank_account_id": "<account_where_end_user_paid>" },
          "notes": "۳۰۰۰ دلار از مشتری نهایی (پرداخت فروش) دریافت شد"
        },
        {
          "customer_id": "<Zamani_customer_id>",
          "transaction_type": "Buy Raw Gold",
          "details": { "purity": 18, "weight_grams": 8, "price": 3000 },
          "notes": "۸ گرم از آقای زمانی خریداری شد (تسویه ۸ گرم بدهی؛ طلای فیزیکی دریافت نشد)"
        },
        {
          "customer_id": "<Zamani_customer_id>",
          "transaction_type": "Send Money",
          "details": { "amount": 3000, "bank_account_id": "<account_used_to_pay_Zamani>" },
          "notes": "۳۰۰۰ دلار به آقای زمانی برای تسویه ۸ گرم پرداخت شد"
        }
      ],
      "outcome": "قلم جواهر شماره ۱۲ فروخته شد (از موجودی ما خارج شد). ما به آقای زمانی ۱۲ گرم بدهکار بودیم؛ ۸ گرم را با پرداخت ۳۰۰۰ دلار تسویه کردیم. ماندهٔ طلای آقای زمانی نزد ما: ۱۲ − ۸ = ۴ گرم.",
      "rules_for_ai": [
        "وقتی کاربر می‌گوید «قلم جواهر شماره X را به مشتری نهایی به Y دلار فروختیم و او به [همکار] برای Z گرم طلا پرداخت کرد»، خروجی به ترتیب: (۱) Give Jewelry (قلم X به مشتری نهایی)؛ (۲) Receive Money (مبلغ Y از مشتری)؛ (۳) Buy Raw Gold (Z گرم از همکار، قیمت Y)؛ (۴) Send Money (مبلغ Y به همکار).",
        "از context: end user → customer_id؛ همکار (مثلاً آقای زمانی) → customer_id؛ قلم «شماره ۱۲» → jewelry_code؛ حساب‌های بانکی از context.",
        "بعد از این معامله بدهی به همکار = N − Z گرم. اینجا: ۱۲ − ۸ = ۴ گرم به آقای زمانی بدهکاریم."
      ]
    },
    {
      "id": "triangular_settlement_gold_on_our_behalf",
      "title": "طرف سوم به جای ما طلا داد (تسویه مثلثی)",
      "context": {
        "we_owe": "ما به آقای زمانی ۱۰ گرم طلا بدهکاریم (ماندهٔ او: +۱۰ گرم).",
        "owes_us": "آقای طالبی به ما ۸ گرم طلا بدهکار است (ماندهٔ او نزد ما: −۸ گرم).",
        "note": "context از سیستم است."
      },
      "user_input": "آقای طالبی ۸ گرم به آقای زمانی به جای ما داد",
      "reasoning": "طالبی ۸ گرم به زمانی به جای ما داد: ما عملاً (۱) ۸ گرم از طالبی دریافت می‌کنیم (بدهی او به ما تسویه می‌شود) و (۲) ۸ گرم به زمانی می‌دهیم (بخشی از بدهی ما به او تسویه می‌شود). پس ۲ تراکنش: Receive Raw Gold 8g از طالبی، سپس Give Raw Gold 8g به زمانی.",
      "expected_transaction_count": 2,
      "logical_steps": [
        "۱. دریافت ۸ گرم از آقای طالبی (بدهی طالبی به ما تسویه می‌شود)",
        "۲. دادن ۸ گرم به آقای زمانی (بخشی از بدهی ما به او تسویه می‌شود)"
      ],
      "expected_output": [
        {
          "customer_id": "<Talebi_customer_id>",
          "transaction_type": "Receive Raw Gold",
          "details": { "weight_grams": 8, "purity": 18 },
          "notes": "آقای طالبی ۸ گرم به جای ما داد؛ ما ۸ گرم از آقای طالبی دریافت کردیم (بدهی او به ما تسویه شد)"
        },
        {
          "customer_id": "<Zamani_customer_id>",
          "transaction_type": "Give Raw Gold",
          "details": { "weight_grams": 8, "purity": 18 },
          "notes": "۸ گرم به آقای زمانی به جای ما داده شد (طالبی به او داد؛ بخشی از بدهی ما تسویه شد)"
        }
      ],
      "outcome": "با آقای طالبی تسویه شد (بدهی ۸ گرمی او به ما صفر شد). به آقای زمانی فقط ۲ گرم بدهکاریم (۱۰ − ۸ = ۲).",
      "rules_for_ai": [
        "وقتی کاربر می‌گوید «[شخص الف] X گرم به [شخص ب] به جای ما داد»، خروجی ۲ تراکنش به ترتیب: (۱) Receive Raw Gold X g از شخص الف؛ (۲) Give Raw Gold X g به شخص ب.",
        "از context: ما به ب، N گرم بدهکاریم؛ الف به ما M گرم بدهکار است. بعد از این معامله: ماندهٔ الف با ما = ۰ (اگر M = X)؛ به ب فقط N − X گرم بدهکاریم.",
        "نام اشخاص را به customer_id از context نگاشت کن. اگر عیار گفته نشد پیش‌فرض (مثلاً 18) بگذار."
      ]
    }
  ]
}
